# EVIDENCE_PACK_TEMPLATE_v2 — OG10 (SSOT_PUBLIC)
# Objetivo: template completo para evidence pack de operações com mudança de estado.

version: "v2"

required_fields:
  - job_id
  - run_id
  - company_id
  - project_id
  - user_id
  - studio_id
  - created_at
  - started_at
  - finished_at
  - repo
  - head_commit
  - tag
  - gates
  - patch
  - artifacts
  - costs
  - signatures
  - pointers

schema:
  job_id: "uuid"
  run_id: "uuid"
  company_id: "uuid"
  project_id: "uuid"
  user_id: "uuid"
  studio_id: "string (ex: S02)"
  created_at: "ISO8601"
  started_at: "ISO8601"
  finished_at: "ISO8601"
  repo: "string"
  head_commit: "string"
  tag: "string"

  gates:
    doctor1:
      verdict: "PASS|FAIL"
      elapsed_ms: "int"
      checks: ["string"]
    doctor2:
      verdict: "PASS|FAIL"
      elapsed_ms: "int"
      checks: ["string"]
    testsprite:
      status: "PASS|FAIL|SKIP"
      tests_run: "int"
      passed: "int"
      failed: "int"
      duration_ms: "int"

  patch:
    diff_ref: "string (path/uri)"
    files_changed: ["string"]
    lines_changed: "int"

  artifacts:
    - name: "string"
      path: "string"
      sha256: "string"
      bytes: "int"

  costs:
    estimated_usd: "number"
    actual_usd: "number"
    credits_spent: "int"

  signatures:
    receipt_sha256: "string"
    receipt_signature_ed25519: "string"

  pointers:
    gndrive_refs: ["string"]
    ssot_refs: ["string"]

invariants:
  - "Se doctor1.verdict=FAIL => pacote FAIL"
  - "Se doctor2.verdict=FAIL => pacote FAIL"
  - "head_commit precisa bater com git rev-parse HEAD no momento do pack"
  - "artifacts[].sha256 precisa ser real"
