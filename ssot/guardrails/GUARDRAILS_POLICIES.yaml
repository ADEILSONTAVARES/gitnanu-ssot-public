guardrails_policies:
  guardrails:
    version: GUARDRAILS_v1
    enabled: true
    risk_class: R3
    fail_mode: closed
    latency_budget_p95_ms:
      R3: 300
      R2: 200
      R1: 100
    layers:
    - id: 1
      name: secret_scanner_regex
      enabled: true
      action: block_or_mask
    - id: 2
      name: prompt_injection_regex
      enabled: true
      action: block
    - id: 3
      name: toxicity_regex
      enabled: true
      action: block
      languages:
      - pt-BR
      - en
    - id: 4
      name: custom_rules_admin
      enabled: true
      ddos:
        per_user_rpm: 30
        per_tenant_rpm: 600
        burst: 10
    - id: 5
      name: pii_detector
      enabled: true
      mode: mask
      entities:
      - EMAIL
      - PHONE
      - CPF
      - CREDIT_CARD
      store_raw: false
    - id: 6
      name: llm_safety_lite
      enabled: true
      threshold: 0.7
      action: block
    - id: 7
      name: llm_safety_strong
      enabled: false
      action: block
    - id: 8
      name: url_filter
      enabled: true
      mode: whitelist
      unshorten: true
      block_private_ips: true
    zero_retention_on_block:
      enabled: true
      store:
        allowed:
        - event_id
        - timestamp
        - user_id
        - tenant_id
        - agent_id
        - reason_code
        - payload_hash
        - masked_preview
        forbidden:
        - raw_payload
        - full_text
        - tool_traces_with_payload
        - logs_with_body
    tool_policy:
      enabled: true
      policies:
      - tool_name: terminal_execute
        risk_class: R3
        requires:
          command_allowlist: true
          human_approval: true
      - tool_name: database_query
        risk_class: R3
        requires:
          tenant_filter: true
          approval_required: true
      - tool_name: web_fetch
        risk_class: R2
        requires:
          url_whitelist: true
          max_size_mb: 5
  zero_retention_on_block:
    enabled: true
    store:
      allowed:
      - event_id
      - timestamp
      - user_id
      - tenant_id
      - agent_id
      - reason_code
      - payload_hash
      - masked_preview
      forbidden:
      - raw_payload
      - full_text
      - tool_traces_with_payload
      - logs_with_body
